<!DOCTYPE html>
<html>
<head>
    <title>Power BI Semantic Models - Relationship Diagrams</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style type="text/css">
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        #header {
            background-color: #2C3E50;
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #header h1 {
            margin: 0;
            font-size: 24px;
        }
        #model-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #model-selector label {
            font-size: 14px;
            font-weight: bold;
        }
        #model-selector select {
            padding: 8px 12px;
            font-size: 14px;
            border: none;
            border-radius: 4px;
            background-color: white;
            color: #2C3E50;
            cursor: pointer;
            min-width: 300px;
        }
        #table-filter {
            position: fixed;
            left: 20px;
            top: 140px;
            width: 280px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-height: calc(100vh - 160px);
            overflow-y: auto;
            display: none;
            z-index: 2000;
        }
        #table-filter h3 {
            margin-top: 0;
            color: #2C3E50;
            border-bottom: 2px solid #3498DB;
            padding-bottom: 10px;
            font-size: 16px;
        }
        #table-filter .close-btn {
            float: right;
            cursor: pointer;
            color: #999;
            font-size: 20px;
            font-weight: bold;
            line-height: 20px;
        }
        #table-filter .close-btn:hover {
            color: #333;
        }
        #table-filter .filter-controls {
            margin-bottom: 10px;
            display: flex;
            gap: 8px;
        }
        #table-filter .filter-controls button {
            padding: 6px 12px;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f8f9fa;
            cursor: pointer;
            flex: 1;
        }
        #table-filter .filter-controls button:hover {
            background-color: #e9ecef;
        }
        #table-filter .table-list {
            max-height: calc(100vh - 260px);
            overflow-y: auto;
        }
        #table-filter .table-item {
            display: flex;
            align-items: center;
            padding: 6px;
            margin: 4px 0;
            cursor: pointer;
            border-radius: 4px;
            font-size: 13px;
        }
        #table-filter .table-item:hover {
            background-color: #f8f9fa;
        }
        #table-filter .table-item input[type="checkbox"] {
            margin-right: 8px;
            cursor: pointer;
        }
        #table-filter .table-item.fact {
            color: #C44545;
            font-weight: 500;
        }
        #table-filter .table-item.dim {
            color: #3BA39F;
        }
        #toggle-filter-btn {
            position: fixed;
            left: 20px;
            top: 140px;
            padding: 10px 15px;
            background-color: #3498DB;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        #toggle-filter-btn:hover {
            background-color: #2980B9;
        }
        #highlight-mode-toggle {
            position: static;
            padding: 8px 12px;
            background-color: #9B59B6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #highlight-mode-toggle:hover {
            background-color: #8E44AD;
        }
        #highlight-mode-toggle.directional {
            background-color: #E67E22;
        }
        #highlight-mode-toggle.directional:hover {
            background-color: #D35400;
        }
        #stats {
            background-color: #34495E;
            color: white;
            padding: 8px 20px;
            display: flex;
            justify-content: center;
            gap: 40px;
            font-size: 13px;
        }
        #mynetwork {
            width: 100%;
            height: calc(100vh - 140px);
            border: 1px solid #ddd;
            background-color: white;
        }
        #info-panel {
            position: fixed;
            right: 20px;
            top: 140px;
            width: 320px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-height: calc(100vh - 160px);
            overflow-y: auto;
            display: none;
            z-index: 2000;
        }
        #info-panel h3 {
            margin-top: 0;
            color: #2C3E50;
            border-bottom: 2px solid #3498DB;
            padding-bottom: 10px;
        }
        #info-panel .close-btn {
            float: right;
            cursor: pointer;
            color: #999;
            font-size: 20px;
            font-weight: bold;
            line-height: 20px;
        }
        #info-panel .close-btn:hover {
            color: #333;
        }
        .relationship-item {
            margin: 10px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-left: 3px solid #3498DB;
            border-radius: 4px;
        }
        .relationship-item.inactive {
            border-left-color: #999;
            opacity: 0.7;
        }
        .relationship-item strong {
            color: #2C3E50;
        }
        .relationship-item .detail {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .legend {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px 20px;
            margin: 10px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 25px;
            flex-wrap: wrap;
        }
        .legend h3 {
            margin: 0;
            color: #2C3E50;
            font-size: 16px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 13px;
        }
        .legend-color {
            width: 30px;
            height: 20px;
            margin-right: 10px;
            border: 1px solid #333;
            border-radius: 3px;
        }
        .legend-color.fact {
            background-color: #FF6B6B;
        }
        .legend-color.dim {
            background-color: #4ECDC4;
            border-radius: 50%;
        }
        .legend-line {
            width: 30px;
            height: 2px;
            margin-right: 10px;
        }
        .legend-line.normal {
            background-color: #2C3E50;
        }
        .legend-line.bidirectional {
            background-color: #8E44AD;
            height: 3px;
        }
        .legend-line.inactive {
            background-color: #999;
            border-top: 2px dashed #999;
            height: 0;
        }
        .instructions {
            background-color: #FFF3CD;
            border: 1px solid #FFE69C;
            border-radius: 8px;
            padding: 10px 20px;
            margin: 10px 20px;
            color: #856404;
            font-size: 13px;
        }
        .instructions strong {
            display: inline;
            margin-right: 8px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>üîó Power BI Semantic Models - Relationships</h1>
        <div id="model-selector">
            <label for="model-select">Select Model:</label>
            <select id="model-select" onchange="loadModel(this.value)">
                <option value="">-- Choose a model --</option>
            </select>
        </div>
    </div>
    <div id="stats">
        <div>üìä <strong id="stat-tables">0</strong> Tables</div>
        <div>üîó <strong id="stat-relationships">0</strong> Relationships</div>
        <div>üì¶ <strong id="stat-facts">0</strong> Fact Tables</div>
        <div>üè∑Ô∏è <strong id="stat-dimensions">0</strong> Dimension Tables</div>
    </div>
    
    <div class="instructions">
        <strong>üí° Interactive Controls:</strong>
        Select a model from the dropdown above. Click on any table to highlight its direct relationships. Connected tables remain colored while unrelated tables are greyed out. Click empty space to reset. Use mouse wheel to zoom, drag to pan.
    </div>
    
    <div class="legend">
        <h3>Legend</h3>
        <div class="legend-item">
            <div class="legend-color fact"></div>
            <span>Fact Table</span>
        </div>
        <div class="legend-item">
            <div class="legend-color dim"></div>
            <span>Dimension Table</span>
        </div>
        <div class="legend-item">
            <div class="legend-line normal"></div>
            <span>One-way</span>
        </div>
        <div class="legend-item">
            <div class="legend-line bidirectional"></div>
            <span>Bidirectional</span>
        </div>
        <div class="legend-item">
            <div class="legend-line inactive"></div>
            <span>Inactive</span>
        </div>
        <button id="highlight-mode-toggle" title="Click to toggle between highlighting all related tables or only tables filtered by selected table">
            Mode: All Relations
        </button>
    </div>
    
    <button id="toggle-filter-btn" onclick="toggleTableFilter()">üìã Filter Tables</button>
    
    <div id="table-filter">
        <span class="close-btn" onclick="toggleTableFilter()">√ó</span>
        <h3>Filter Tables</h3>
        <div class="filter-controls">
            <button onclick="selectAllTables()">Select All</button>
            <button onclick="deselectAllTables()">Deselect All</button>
        </div>
        <div class="table-list" id="table-list"></div>
    </div>
    
    <div id="mynetwork"></div>
    
    <div id="info-panel">
        <span class="close-btn" onclick="closeInfoPanel()">√ó</span>
        <h3 id="selected-table-name">Table Information</h3>
        <div id="relationships-list"></div>
    </div>

    <script type="text/javascript">
        // All models data
        const modelsData = {"Model_A": {"data": {"nodes": [{"id": "bronze pbi_refresh_schedule_latest", "label": "bronze pbi_refresh_schedule_latest", "title": "bronze pbi_refresh_schedule_latest\nFact Table\nConnections: 3", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6", "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e", "bronze pbi_semantic_model_latest"]}, {"id": "LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6", "label": "LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6", "title": "LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_refresh_schedule_latest"]}, {"id": "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e", "label": "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e", "title": "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_refresh_schedule_latest"]}, {"id": "bronze pbi_columns_enhanced_latest", "label": "bronze pbi_columns_enhanced_latest", "title": "bronze pbi_columns_enhanced_latest\nFact Table\nConnections: 3", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e", "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a", "bronze pbi_tables_enhanced_latest"]}, {"id": "LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e", "label": "LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e", "title": "LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_columns_enhanced_latest"]}, {"id": "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a", "label": "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a", "title": "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_columns_enhanced_latest"]}, {"id": "bronze pbi_tables_enhanced_latest", "label": "bronze pbi_tables_enhanced_latest", "title": "bronze pbi_tables_enhanced_latest\nDimension Table\nConnections: 4", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_semantic_model_latest", "bronze pbi_relationships_latest", "bronze pbi_columns_enhanced_latest", "bronze pbi_measures_latest"]}, {"id": "bronze pbi_semantic_model_latest", "label": "bronze pbi_semantic_model_latest", "title": "bronze pbi_semantic_model_latest\nDimension Table\nConnections: 3", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_tables_enhanced_latest", "bronze pbi_refresh_schedule_latest", "pbi_reports_apps"]}, {"id": "bronze pbi_relationships_latest", "label": "bronze pbi_relationships_latest", "title": "bronze pbi_relationships_latest\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_tables_enhanced_latest"]}, {"id": "bronze pbi_measures_latest", "label": "bronze pbi_measures_latest", "title": "bronze pbi_measures_latest\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["bronze pbi_tables_enhanced_latest"]}, {"id": "pbi_reports_apps", "label": "pbi_reports_apps", "title": "pbi_reports_apps\nFact Table\nConnections: 2", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9", "bronze pbi_semantic_model_latest"]}, {"id": "LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9", "label": "LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9", "title": "LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_reports_apps"]}], "edges": [{"from": "LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6", "to": "bronze pbi_refresh_schedule_latest", "label": "M:O \u2192", "title": "LocalDateTable_907b62d9-c430-4345-bb71-3f76e04d10c6.Date \u2192 bronze pbi_refresh_schedule_latest.r_BatchTimestamp", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "r_BatchTimestamp", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e", "to": "bronze pbi_refresh_schedule_latest", "label": "M:O \u2192", "title": "LocalDateTable_efda61d6-7c36-44b2-bd23-f825ff52df1e.Date \u2192 bronze pbi_refresh_schedule_latest.r_StepTimestamp", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "r_StepTimestamp", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e", "to": "bronze pbi_columns_enhanced_latest", "label": "M:O \u2192", "title": "LocalDateTable_1cced441-dfeb-424b-af64-dfa7e5f3055e.Date \u2192 bronze pbi_columns_enhanced_latest.ModifiedTime", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "ModifiedTime", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a", "to": "bronze pbi_columns_enhanced_latest", "label": "M:O \u2192", "title": "LocalDateTable_c7d7099a-6ba8-4759-a3bb-9dc5bcb8d50a.Date \u2192 bronze pbi_columns_enhanced_latest.StructureModifiedTime", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "StructureModifiedTime", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_semantic_model_latest", "to": "bronze pbi_tables_enhanced_latest", "label": "M:O \u2192", "title": "bronze pbi_semantic_model_latest.dataset_batch_Link \u2192 bronze pbi_tables_enhanced_latest.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_tables_enhanced_latest", "to": "bronze pbi_relationships_latest", "label": "M:O \u2192", "title": "bronze pbi_tables_enhanced_latest.table_Link \u2192 bronze pbi_relationships_latest.tableFrom_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "tableFrom_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_tables_enhanced_latest", "to": "bronze pbi_columns_enhanced_latest", "label": "M:O \u2192", "title": "bronze pbi_tables_enhanced_latest.table_Link \u2192 bronze pbi_columns_enhanced_latest.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_tables_enhanced_latest", "to": "bronze pbi_measures_latest", "label": "M:O \u2192", "title": "bronze pbi_tables_enhanced_latest.table_Link \u2192 bronze pbi_measures_latest.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_refresh_schedule_latest", "to": "bronze pbi_semantic_model_latest", "label": "O:O \u2194", "title": "bronze pbi_refresh_schedule_latest.dataset_batch_Link \u2192 bronze pbi_semantic_model_latest.dataset_batch_Link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "O:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9", "to": "pbi_reports_apps", "label": "M:O \u2192", "title": "LocalDateTable_800ad26a-61c3-4997-a1dd-253d019fe4b9.Date \u2192 pbi_reports_apps.r_BatchTimestamp", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "r_BatchTimestamp", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "bronze pbi_semantic_model_latest", "to": "pbi_reports_apps", "label": "M:O \u2192", "title": "bronze pbi_semantic_model_latest.SemanticModelID \u2192 pbi_reports_apps.SemanticModelID", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "SemanticModelID", "to_column": "SemanticModelID", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}], "stats": {"tables": 12, "relationships": 11, "facts": 5, "dimensions": 7}}, "stats": {"tables": 12, "relationships": 11, "facts": 5, "dimensions": 7}}, "Model_B": {"data": {"nodes": [{"id": "pbi_semantic_models", "label": "pbi_semantic_models", "title": "pbi_semantic_models\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["Dim Date", "pbi_calcdependency"]}, {"id": "Dim Date", "label": "Dim Date", "title": "Dim Date\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_models"]}, {"id": "pbi_calcdependency", "label": "pbi_calcdependency", "title": "pbi_calcdependency\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_models", "Search"]}, {"id": "Search", "label": "Search", "title": "Search\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_calcdependency"]}], "edges": [{"from": "Dim Date", "to": "pbi_semantic_models", "label": "M:O \u2192", "title": "Dim Date.Date \u2192 pbi_semantic_models.Date", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "Date", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_models", "to": "pbi_calcdependency", "label": "M:O \u2192", "title": "pbi_semantic_models.dataset_batch_Link \u2192 pbi_calcdependency.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_calcdependency", "to": "Search", "label": "M:M \u2194", "title": "pbi_calcdependency.Search_Link \u2192 Search.Search_Link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "Search_Link", "to_column": "Search_Link", "cardinality": "M:M", "cross_filtering": "bothDirections", "is_active": true}], "stats": {"tables": 4, "relationships": 3, "facts": 1, "dimensions": 3}}, "stats": {"tables": 4, "relationships": 3, "facts": 1, "dimensions": 3}}, "Model_C": {"data": {"nodes": [{"id": "pbi_snapshots_change_history", "label": "pbi_snapshots_change_history", "title": "pbi_snapshots_change_history\nFact Table\nConnections: 2", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_snapshots_mapping", "pbi_semantic_model"]}, {"id": "pbi_snapshots_mapping", "label": "pbi_snapshots_mapping", "title": "pbi_snapshots_mapping\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_snapshots_change_history"]}, {"id": "pbi_semantic_model", "label": "pbi_semantic_model", "title": "pbi_semantic_model\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_snapshots_change_history"]}], "edges": [{"from": "pbi_snapshots_mapping", "to": "pbi_snapshots_change_history", "label": "M:O \u2192", "title": "pbi_snapshots_mapping.Table_Link \u2192 pbi_snapshots_change_history.Table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Table_Link", "to_column": "Table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_snapshots_change_history", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_snapshots_change_history.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}], "stats": {"tables": 3, "relationships": 2, "facts": 1, "dimensions": 2}}, "stats": {"tables": 3, "relationships": 2, "facts": 1, "dimensions": 2}}, "Model_D": {"data": {"nodes": [{"id": "pbi_tables_enhanced", "label": "pbi_tables_enhanced", "title": "pbi_tables_enhanced\nDimension Table\nConnections: 6", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_model", "pbi_measures", "pbi_partitions", "pbi_tablepermissions", "pbi_relationships", "pbi_columns_enhanced"]}, {"id": "pbi_semantic_model", "label": "pbi_semantic_model", "title": "pbi_semantic_model\nDimension Table\nConnections: 7", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced", "pbi_workspace_parameters", "pbi_semantic_model_parameters", "pbi_reports", "pbi_rolemembership", "pbi_model", "pbi_catalogue"]}, {"id": "pbi_measures", "label": "pbi_measures", "title": "pbi_measures\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced"]}, {"id": "pbi_partitions", "label": "pbi_partitions", "title": "pbi_partitions\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced"]}, {"id": "pbi_reports_pages", "label": "pbi_reports_pages", "title": "pbi_reports_pages\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_reports"]}, {"id": "pbi_reports", "label": "pbi_reports", "title": "pbi_reports\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_reports_pages", "pbi_semantic_model"]}, {"id": "pbi_tablepermissions", "label": "pbi_tablepermissions", "title": "pbi_tablepermissions\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced"]}, {"id": "pbi_workspace_parameters", "label": "pbi_workspace_parameters", "title": "pbi_workspace_parameters\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_model"]}, {"id": "pbi_semantic_model_parameters", "label": "pbi_semantic_model_parameters", "title": "pbi_semantic_model_parameters\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_model"]}, {"id": "pbi_relationships", "label": "pbi_relationships", "title": "pbi_relationships\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced"]}, {"id": "pbi_report_catalogue", "label": "pbi_report_catalogue", "title": "pbi_report_catalogue\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_catalogue"]}, {"id": "pbi_catalogue", "label": "pbi_catalogue", "title": "pbi_catalogue\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_report_catalogue", "pbi_semantic_model"]}, {"id": "pbi_columns_enhanced", "label": "pbi_columns_enhanced", "title": "pbi_columns_enhanced\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_tables_enhanced"]}, {"id": "pbi_rolemembership", "label": "pbi_rolemembership", "title": "pbi_rolemembership\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_model"]}, {"id": "pbi_model", "label": "pbi_model", "title": "pbi_model\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_model"]}], "edges": [{"from": "pbi_semantic_model", "to": "pbi_tables_enhanced", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_tables_enhanced.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_tables_enhanced", "to": "pbi_measures", "label": "M:O \u2192", "title": "pbi_tables_enhanced.table_Link \u2192 pbi_measures.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_tables_enhanced", "to": "pbi_partitions", "label": "M:O \u2192", "title": "pbi_tables_enhanced.table_Link \u2192 pbi_partitions.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_reports", "to": "pbi_reports_pages", "label": "M:O \u2192", "title": "pbi_reports.Report_Link \u2192 pbi_reports_pages.Report_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Report_Link", "to_column": "Report_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_tables_enhanced", "to": "pbi_tablepermissions", "label": "M:O \u2192", "title": "pbi_tables_enhanced.table_Link \u2192 pbi_tablepermissions.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_workspace_parameters", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_workspace_parameters.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_semantic_model_parameters", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_semantic_model_parameters.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_tables_enhanced", "to": "pbi_relationships", "label": "M:O \u2192", "title": "pbi_tables_enhanced.table_Link \u2192 pbi_relationships.tableFrom_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "tableFrom_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_catalogue", "to": "pbi_report_catalogue", "label": "M:O \u2192", "title": "pbi_catalogue.Semantic Model ID \u2192 pbi_report_catalogue.Semantic Model ID", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Semantic Model ID", "to_column": "Semantic Model ID", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_tables_enhanced", "to": "pbi_columns_enhanced", "label": "M:O \u2192", "title": "pbi_tables_enhanced.table_Link \u2192 pbi_columns_enhanced.table_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "table_Link", "to_column": "table_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_reports", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_reports.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_rolemembership", "label": "M:O \u2192", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_rolemembership.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_semantic_model", "to": "pbi_model", "label": "O:O \u2194", "title": "pbi_semantic_model.dataset_batch_Link \u2192 pbi_model.dataset_batch_Link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "O:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "pbi_catalogue", "to": "pbi_semantic_model", "label": "M:O \u2192", "title": "pbi_catalogue.Semantic Model ID \u2192 pbi_semantic_model.Semantic Model ID", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Semantic Model ID", "to_column": "Semantic Model ID", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}], "stats": {"tables": 15, "relationships": 14, "facts": 11, "dimensions": 4}}, "stats": {"tables": 15, "relationships": 14, "facts": 11, "dimensions": 4}}, "Model_E": {"data": {"nodes": [{"id": "Fact Daily Refresh", "label": "Fact Daily Refresh", "title": "Fact Daily Refresh\nFact Table\nConnections: 3", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["Dim TableDataFlow", "Dim Workspace", "Dim Date"]}, {"id": "Dim TableDataFlow", "label": "Dim TableDataFlow", "title": "Dim TableDataFlow\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["Fact Daily Refresh"]}, {"id": "Dim Workspace", "label": "Dim Workspace", "title": "Dim Workspace\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["Fact Daily Refresh"]}, {"id": "Dim Date", "label": "Dim Date", "title": "Dim Date\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["Fact Daily Refresh"]}], "edges": [{"from": "Dim TableDataFlow", "to": "Fact Daily Refresh", "label": "M:O \u2194", "title": "Dim TableDataFlow.objectId \u2192 Fact Daily Refresh.objectId", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "objectId", "to_column": "objectId", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "Dim Workspace", "to": "Fact Daily Refresh", "label": "M:O \u2194", "title": "Dim Workspace.workspaceId \u2192 Fact Daily Refresh.workspaceId", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "workspaceId", "to_column": "workspaceId", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "Dim Date", "to": "Fact Daily Refresh", "label": "M:O \u2194", "title": "Dim Date.Date \u2192 Fact Daily Refresh.DateID", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "Date", "to_column": "DateID", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}], "stats": {"tables": 4, "relationships": 3, "facts": 1, "dimensions": 3}}, "stats": {"tables": 4, "relationships": 3, "facts": 1, "dimensions": 3}}, "Model_F": {"data": {"nodes": [{"id": "pbi_storagetablecolumnsegments", "label": "pbi_storagetablecolumnsegments", "title": "pbi_storagetablecolumnsegments\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetablecolumns"]}, {"id": "pbi_storagetablecolumns", "label": "pbi_storagetablecolumns", "title": "pbi_storagetablecolumns\nFact Table\nConnections: 5", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetablecolumnsegments", "pbi_calcdependency_summary", "pbi_calcdependency", "pbi_storagetables", "report_columns_summary"]}, {"id": "pbi_storagetables", "label": "pbi_storagetables", "title": "pbi_storagetables\nFact Table\nConnections: 3", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_models", "pbi_table_summary", "pbi_storagetablecolumns"]}, {"id": "pbi_semantic_models", "label": "pbi_semantic_models", "title": "pbi_semantic_models\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetables", "Dim Date"]}, {"id": "pbi_calcdependency_summary", "label": "pbi_calcdependency_summary", "title": "pbi_calcdependency_summary\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetablecolumns"]}, {"id": "pbi_calcdependency", "label": "pbi_calcdependency", "title": "pbi_calcdependency\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetablecolumns"]}, {"id": "Dim Date", "label": "Dim Date", "title": "Dim Date\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_semantic_models"]}, {"id": "pbi_table_summary", "label": "pbi_table_summary", "title": "pbi_table_summary\nDimension Table\nConnections: 1", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetables"]}, {"id": "report_columns_summary", "label": "report_columns_summary", "title": "report_columns_summary\nDimension Table\nConnections: 2", "color": {"background": "#4ECDC4", "border": "#3BA39F", "highlight": {"background": "#6FE8DE", "border": "#2A7A77"}}, "shape": "ellipse", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["pbi_storagetablecolumns", "report_columns_visuals_detail"]}, {"id": "report_columns_visuals_detail", "label": "report_columns_visuals_detail", "title": "report_columns_visuals_detail\nFact Table\nConnections: 1", "color": {"background": "#FF6B6B", "border": "#C44545", "highlight": {"background": "#FF8787", "border": "#A03333"}}, "shape": "box", "font": {"size": 14, "color": "#000000", "bold": true}, "connections": ["report_columns_summary"]}], "edges": [{"from": "pbi_storagetablecolumns", "to": "pbi_storagetablecolumnsegments", "label": "M:O \u2194", "title": "pbi_storagetablecolumns.TableColumn_Link \u2192 pbi_storagetablecolumnsegments.TableColumn_Link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "TableColumn_Link", "to_column": "TableColumn_Link", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "pbi_semantic_models", "to": "pbi_storagetables", "label": "M:O \u2192", "title": "pbi_semantic_models.dataset_batch_Link \u2192 pbi_storagetables.dataset_batch_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "dataset_batch_Link", "to_column": "dataset_batch_Link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_calcdependency_summary", "to": "pbi_storagetablecolumns", "label": "M:O \u2194", "title": "pbi_calcdependency_summary.xReferenceObject_Link \u2192 pbi_storagetablecolumns.xReferenceObject_link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "xReferenceObject_Link", "to_column": "xReferenceObject_link", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "pbi_storagetablecolumns", "to": "pbi_calcdependency", "label": "M:M \u2192", "title": "pbi_storagetablecolumns.xReferenceObject_link \u2192 pbi_calcdependency.xReferenceObject_Link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "xReferenceObject_link", "to_column": "xReferenceObject_Link", "cardinality": "M:M", "cross_filtering": "oneDirection", "is_active": true}, {"from": "Dim Date", "to": "pbi_semantic_models", "label": "M:O \u2192", "title": "Dim Date.Date \u2192 pbi_semantic_models.Date", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Date", "to_column": "Date", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}, {"from": "pbi_table_summary", "to": "pbi_storagetables", "label": "M:O \u2194", "title": "pbi_table_summary.UniqueTableDatasetID \u2192 pbi_storagetables.UniqueTableDatasetID", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "UniqueTableDatasetID", "to_column": "UniqueTableDatasetID", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "pbi_storagetables", "to": "pbi_storagetablecolumns", "label": "M:O \u2194", "title": "pbi_storagetables.Table_Link \u2192 pbi_storagetablecolumns.Table_Link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "Table_Link", "to_column": "Table_Link", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "report_columns_summary", "to": "pbi_storagetablecolumns", "label": "M:O \u2194", "title": "report_columns_summary.Report_colum_link \u2192 pbi_storagetablecolumns.Report_columns_link", "arrows": "to, from", "dashes": false, "color": "#8E44AD", "width": 2.5, "from_column": "Report_colum_link", "to_column": "Report_columns_link", "cardinality": "M:O", "cross_filtering": "bothDirections", "is_active": true}, {"from": "report_columns_summary", "to": "report_columns_visuals_detail", "label": "M:O \u2192", "title": "report_columns_summary.Report_colum_link \u2192 report_columns_visuals_detail.Report_column_link", "arrows": "to", "dashes": false, "color": "#2C3E50", "width": 2, "from_column": "Report_colum_link", "to_column": "Report_column_link", "cardinality": "M:O", "cross_filtering": "oneDirection", "is_active": true}], "stats": {"tables": 10, "relationships": 9, "facts": 5, "dimensions": 5}}, "stats": {"tables": 10, "relationships": 9, "facts": 5, "dimensions": 5}}};
        
        let network = null;
        let nodes = null;
        let edges = null;
        let currentModelData = null;
        let selectedNode = null;
        let visibleTables = new Set();
        let allNodesData = [];
        let allEdgesData = [];
        
        // Populate dropdown
        const select = document.getElementById('model-select');
        Object.keys(modelsData).sort().forEach(modelName => {
            const option = document.createElement('option');
            option.value = modelName;
            option.textContent = modelName;
            select.appendChild(option);
        });
        
        // Load first model by default
        if (Object.keys(modelsData).length > 0) {
            const firstModel = Object.keys(modelsData).sort()[0];
            select.value = firstModel;
            loadModel(firstModel);
        }
        
        // Highlight mode toggle
        let highlightDirectional = false;
        const toggleBtn = document.getElementById('highlight-mode-toggle');
        toggleBtn.addEventListener('click', () => {
            highlightDirectional = !highlightDirectional;
            toggleBtn.textContent = highlightDirectional ? 'Mode: Filter Direction' : 'Mode: All Relations';
            toggleBtn.classList.toggle('directional', highlightDirectional);
            resetHighlight();
        });
        
        function loadModel(modelName) {
            if (!modelName || !modelsData[modelName]) return;
            
            currentModelData = modelsData[modelName];
            const data = currentModelData.data;
            
            // Store original data
            allNodesData = data.nodes;
            allEdgesData = data.edges;
            
            // Initialize all tables as visible
            visibleTables = new Set(allNodesData.map(n => n.id));
            
            // Update stats
            document.getElementById('stat-tables').textContent = currentModelData.stats.tables;
            document.getElementById('stat-relationships').textContent = currentModelData.stats.relationships;
            document.getElementById('stat-facts').textContent = currentModelData.stats.facts;
            document.getElementById('stat-dimensions').textContent = currentModelData.stats.dimensions;
            
            // Populate table filter list
            populateTableFilter();
            
            // Create or update network
            nodes = new vis.DataSet(data.nodes);
            edges = new vis.DataSet(data.edges);
            
            const container = document.getElementById('mynetwork');
            const networkData = { nodes: nodes, edges: edges };
            
            const options = {
                physics: {
                    enabled: true,
                    solver: 'forceAtlas2Based',
                    forceAtlas2Based: {
                        gravitationalConstant: -50,
                        centralGravity: 0.01,
                        springLength: 150,
                        springConstant: 0.08,
                        damping: 0.4,
                        avoidOverlap: 0.5
                    },
                    stabilization: {
                        enabled: true,
                        iterations: 200,
                        updateInterval: 25
                    }
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    navigationButtons: true,
                    keyboard: true
                },
                edges: {
                    smooth: {
                        type: 'continuous',
                        roundness: 0.5
                    },
                    font: {
                        size: 11,
                        align: 'middle'
                    }
                },
                nodes: {
                    borderWidth: 2,
                    borderWidthSelected: 4
                }
            };
            
            if (network) {
                network.destroy();
            }
            
            network = new vis.Network(container, networkData, options);
            
            // Click on node
            network.on('click', function(params) {
                if (params.nodes.length > 0) {
                    const nodeId = params.nodes[0];
                    selectNode(nodeId);
                } else {
                    resetHighlight();
                }
            });
            
            closeInfoPanel();
        }
        
        function selectNode(nodeId) {
            selectedNode = nodeId;
            const nodeData = allNodesData.find(n => n.id === nodeId);
            
            if (!nodeData) return;
            
            // Only work with visible nodes
            const visibleNodesArray = allNodesData.filter(n => visibleTables.has(n.id));
            
            // Get connected nodes (only among visible ones)
            let connectedNodes;
            if (highlightDirectional) {
                // Recursively find ALL tables that are filtered BY the selected table
                // Follow the arrow chain: if A filters B, and B filters C, then A transitively filters C
                // For bidirectional relationships (many-to-many), follow both directions
                connectedNodes = new Set();
                const toVisit = [nodeId];
                const visited = new Set([nodeId]);
                
                while (toVisit.length > 0) {
                    const current = toVisit.shift();
                    allEdgesData.forEach(e => {
                        // Follow outgoing edges: current table filters another table
                        if (e.from === current && visibleTables.has(e.to) && !visited.has(e.to)) {
                            connectedNodes.add(e.to);
                            visited.add(e.to);
                            toVisit.push(e.to);
                        }
                        // Follow incoming edges: another table filters current table
                        if (e.to === current && visibleTables.has(e.from) && !visited.has(e.from)) {
                            connectedNodes.add(e.from);
                            visited.add(e.from);
                            toVisit.push(e.from);
                        }
                    });
                }
            } else {
                // Original behavior: all connections
                connectedNodes = new Set(nodeData.connections.filter(c => visibleTables.has(c)));
            }
            connectedNodes.add(nodeId);
            
            // Update node styles (only for visible nodes)
            visibleNodesArray.forEach(node => {
                if (connectedNodes.has(node.id)) {
                    nodes.update({
                        id: node.id,
                        color: node.color,
                        opacity: 1
                    });
                } else {
                    nodes.update({
                        id: node.id,
                        color: {
                            background: '#E0E0E0',
                            border: '#BDBDBD',
                            highlight: {
                                background: '#E0E0E0',
                                border: '#BDBDBD'
                            }
                        },
                        opacity: 0.3
                    });
                }
            });
            
            // Update edge styles (only for visible edges)
            const visibleEdgesArray = allEdgesData.filter(e => 
                visibleTables.has(e.from) && visibleTables.has(e.to)
            );
            
            const relatedEdges = allEdgesData.filter(e => 
                (e.from === nodeId || e.to === nodeId) && 
                visibleTables.has(e.from) && visibleTables.has(e.to)
            );
            
            const currentEdges = edges.get();
            visibleEdgesArray.forEach(edge => {
                let isRelated;
                if (highlightDirectional) {
                    // Highlight edges in the filter chain
                    // Both nodes must be in the connected set (either direct or transitive)
                    isRelated = connectedNodes.has(edge.from) && connectedNodes.has(edge.to);
                } else {
                    // Original behavior: both directions
                    isRelated = edge.from === nodeId || edge.to === nodeId;
                }
                
                const edgeInGraph = currentEdges.find(e => 
                    e.from === edge.from && e.to === edge.to
                );
                if (edgeInGraph) {
                    edges.update({
                        id: edgeInGraph.id,
                        color: isRelated ? edge.color : '#E0E0E0',
                        width: isRelated ? edge.width : 1,
                        opacity: isRelated ? 1 : 0.2
                    });
                }
            });
            
            // Show info panel (always show all relationships regardless of mode)
            showInfoPanel(nodeId, relatedEdges);
        }
        
        function resetHighlight() {
            selectedNode = null;
            
            // Only restore visible nodes
            const visibleNodesArray = allNodesData.filter(n => visibleTables.has(n.id));
            visibleNodesArray.forEach(node => {
                nodes.update({
                    id: node.id,
                    color: node.color,
                    opacity: 1
                });
            });
            
            // Only restore visible edges
            const visibleEdgesArray = allEdgesData.filter(e => 
                visibleTables.has(e.from) && visibleTables.has(e.to)
            );
            const currentEdges = edges.get();
            visibleEdgesArray.forEach(edge => {
                const edgeInGraph = currentEdges.find(e => 
                    e.from === edge.from && e.to === edge.to
                );
                if (edgeInGraph) {
                    edges.update({
                        id: edgeInGraph.id,
                        color: edge.color,
                        width: edge.width,
                        opacity: 1
                    });
                }
            });
            
            closeInfoPanel();
        }
        
        function showInfoPanel(nodeId, relatedEdges) {
            const panel = document.getElementById('info-panel');
            const tableName = document.getElementById('selected-table-name');
            const relationshipsList = document.getElementById('relationships-list');
            
            tableName.textContent = nodeId;
            
            let html = '<div style="margin-bottom: 15px; color: #666;">' + 
                       '<strong>' + relatedEdges.length + '</strong> direct relationship(s)</div>';
            
            relatedEdges.forEach(edge => {
                const isOutgoing = edge.from === nodeId;
                const otherTable = isOutgoing ? edge.to : edge.from;
                const direction = edge.arrows === 'to, from' ? '‚Üî' : (isOutgoing ? '‚Üí' : '‚Üê');
                const inactiveClass = edge.is_active ? '' : ' inactive';
                
                html += '<div class="relationship-item' + inactiveClass + '">';
                html += '<strong>' + direction + ' ' + otherTable + '</strong>';
                html += '<div class="detail">';
                html += 'Cardinality: ' + edge.cardinality + '<br>';
                html += (isOutgoing ? nodeId : otherTable) + '.' + edge.from_column + 
                       ' ‚Üí ' + (isOutgoing ? otherTable : nodeId) + '.' + edge.to_column;
                if (!edge.is_active) {
                    html += '<br><em>Inactive</em>';
                }
                html += '</div></div>';
            });
            
            relationshipsList.innerHTML = html;
            panel.style.display = 'block';
        }
        
        function closeInfoPanel() {
            document.getElementById('info-panel').style.display = 'none';
        }
        
        function toggleTableFilter() {
            const panel = document.getElementById('table-filter');
            const btn = document.getElementById('toggle-filter-btn');
            if (panel.style.display === 'none' || panel.style.display === '') {
                panel.style.display = 'block';
                btn.style.display = 'none';
            } else {
                panel.style.display = 'none';
                btn.style.display = 'block';
            }
        }
        
        function populateTableFilter() {
            const tableList = document.getElementById('table-list');
            if (!tableList) return;
            
            tableList.innerHTML = '';
            
            // Get fact tables
            const factTables = allNodesData.filter(n => n.shape === 'box').map(n => n.id);
            
            // Sort tables alphabetically
            const sortedTables = [...allNodesData].sort((a, b) => a.id.localeCompare(b.id));
            
            sortedTables.forEach(node => {
                const isFact = factTables.includes(node.id);
                const div = document.createElement('div');
                div.className = 'table-item ' + (isFact ? 'fact' : 'dim');
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = 'table-' + node.id.replace(/[^a-zA-Z0-9]/g, '_');
                checkbox.checked = visibleTables.has(node.id);
                checkbox.setAttribute('data-table-id', node.id);
                
                const label = document.createElement('label');
                label.textContent = node.id;
                label.style.cursor = 'pointer';
                label.setAttribute('for', checkbox.id);
                
                div.appendChild(checkbox);
                div.appendChild(label);
                tableList.appendChild(div);
            });
            
            // Add event listeners after all elements are created
            sortedTables.forEach(node => {
                const checkboxId = 'table-' + node.id.replace(/[^a-zA-Z0-9]/g, '_');
                const checkbox = document.getElementById(checkboxId);
                console.log('Looking for checkbox:', checkboxId, 'Found:', checkbox);
                if (checkbox) {
                    checkbox.addEventListener('change', function() {
                        const tableId = this.getAttribute('data-table-id');
                        console.log('Checkbox changed for:', tableId);
                        toggleTable(tableId);
                    });
                } else {
                    console.error('Checkbox not found for table:', node.id);
                }
            });
        }
        
        function toggleTable(tableId) {
            console.log('toggleTable called for:', tableId);
            if (visibleTables.has(tableId)) {
                visibleTables.delete(tableId);
                console.log('Removed table:', tableId);
            } else {
                visibleTables.add(tableId);
                console.log('Added table:', tableId);
            }
            updateVisibleTables();
        }
        
        function selectAllTables() {
            visibleTables = new Set(allNodesData.map(n => n.id));
            updateTableCheckboxes();
            updateVisibleTables();
        }
        
        function deselectAllTables() {
            visibleTables.clear();
            updateTableCheckboxes();
            updateVisibleTables();
        }
        
        function updateTableCheckboxes() {
            allNodesData.forEach(node => {
                const checkbox = document.getElementById('table-' + node.id.replace(/[^a-zA-Z0-9]/g, '_'));
                if (checkbox) {
                    checkbox.checked = visibleTables.has(node.id);
                }
            });
        }
        
        function updateVisibleTables() {
            if (!nodes || !edges) return;
            
            // Filter nodes
            const visibleNodes = allNodesData.filter(n => visibleTables.has(n.id));
            
            // Filter edges (only show if both tables are visible)
            const visibleEdges = allEdgesData.filter(e => 
                visibleTables.has(e.from) && visibleTables.has(e.to)
            );
            
            // Clear and update datasets
            try {
                nodes.clear();
                edges.clear();
                
                if (visibleNodes.length > 0) {
                    nodes.add(visibleNodes);
                }
                if (visibleEdges.length > 0) {
                    edges.add(visibleEdges);
                }
                
                // Fit the network to show all visible nodes
                if (network && visibleNodes.length > 0) {
                    network.fit({
                        animation: {
                            duration: 500,
                            easingFunction: 'easeInOutQuad'
                        }
                    });
                }
            } catch (e) {
                console.error('Error updating visible tables:', e);
            }
            
            // Update stats
            const factCount = visibleNodes.filter(n => n.shape === 'box').length;
            document.getElementById('stat-tables').textContent = visibleNodes.length;
            document.getElementById('stat-relationships').textContent = visibleEdges.length;
            document.getElementById('stat-facts').textContent = factCount;
            document.getElementById('stat-dimensions').textContent = visibleNodes.length - factCount;
            
            // Reset selection if selected node is no longer visible
            if (selectedNode && !visibleTables.has(selectedNode)) {
                selectedNode = null;
                closeInfoPanel();
            }
        }
    </script>
</body>
</html>